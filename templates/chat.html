<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>K 온라인 채팅방 - {{ room }}</title>
<link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
<script src="https://cdn.socket.io/4.7.1/socket.io.min.js"></script>
</head>
<body>
<div class="form-container">
  <h1>K 온라인 채팅방</h1>
  <h2>{{ room }}</h2>
  <div id="chat" style="height:300px;overflow:auto;border:1px solid #ccc;padding:5px;margin-bottom:5px;"></div>
  <input id="message" type="text" placeholder="메시지 입력">
  <button onclick="sendMessage()">보내기</button>
</div>

<script>
var socket = io();
var username = "{{ username }}";
var room = "{{ room }}";

socket.emit("join", {username: username, room: room});

function sendMessage(){
  var msg = document.getElementById("message").value;
  if(msg.trim()=="") return;
  socket.emit("send_message", {username: username, room: room, msg: msg});
  document.getElementById("message").value="";
}

socket.on("message", function(data){
  var chat = document.getElementById("chat");
  chat.innerHTML += "<p><b>"+data.username+":</b> "+data.msg+"</p>";
  chat.scrollTop = chat.scrollHeight;
});
</script>
</body>
</html>
